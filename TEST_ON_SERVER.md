# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ vov.sneakernet.top

## –°—Ç–∞—Ç—É—Å –ª–æ–∫–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

‚úÖ **–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!**
- 20 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ
- 0 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–≤–∞–ª–µ–Ω–æ
- –°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@vov.sneakernet.top
cd /root/stealth-vpn-server  # –∏–ª–∏ –ø—É—Ç—å –∫ –≤–∞—à–µ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```bash
# –ï—Å–ª–∏ —É –≤–∞—Å Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git pull

# –ò–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã
# scp scripts/*.sh root@vov.sneakernet.top:/root/stealth-vpn-server/scripts/
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
./scripts/test-migration.sh
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–π—Ç–∏ ‚úì

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

```bash
# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose ps

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
cat data/stealth-vpn/configs/users.json | python3 -m json.tool

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
df -h
```

### 5. –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –†—É—á–Ω–æ–π –±—ç–∫–∞–ø –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
tar -czf ~/manual-backup-$(date +%Y%m%d_%H%M%S).tar.gz \
    docker-compose.yml \
    config/Caddyfile \
    .env \
    data/stealth-vpn/configs/ \
    data/caddy/certificates/

# –ü—Ä–æ–≤–µ—Ä–∫–∞
ls -lh ~/manual-backup-*
```

### 6. –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
./scripts/migrate-to-new-version.sh
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç:**
1. –ó–∞–ø—Ä–æ—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–≤–≤–µ–¥–∏—Ç–µ `y`)
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞ —á–µ—Ä–µ–∑ BackupManager
3. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
5. –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–æ–≤
6. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~5-10 –º–∏–Ω—É—Ç

### 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose ps

# –õ–æ–≥–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫)
docker compose logs --tail=50

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
curl -k https://vov.sneakernet.top/api/v2/storage/login

# –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL
ls -la data/caddy/certificates/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
cat data/stealth-vpn/configs/users.json
```

### 8. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```bash
# –õ–æ–≥–∏ VPN —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose logs xray --tail=20
docker compose logs trojan --tail=20
docker compose logs singbox --tail=20
docker compose logs wireguard --tail=20
```

**–ù–∞ –∫–ª–∏–µ–Ω—Ç–µ:** –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

## –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞—Ç

```bash
./scripts/rollback-migration.sh
```

### –†—É—á–Ω–æ–π –æ—Ç–∫–∞—Ç

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker compose down

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤
cp docker-compose.yml.pre-migration docker-compose.yml
cp config/Caddyfile.pre-migration config/Caddyfile

# –ó–∞–ø—É—Å–∫
docker compose up -d
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä—É—á–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞

```bash
cd ~
tar -xzf manual-backup-*.tar.gz -C /root/stealth-vpn-server/
cd /root/stealth-vpn-server
docker compose up -d
```

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏

‚úÖ **–ú–∏–≥—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞, –µ—Å–ª–∏:**
- –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç "Up (healthy)"
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞
- VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
- SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
- –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –º–µ—Å—Ç–µ

## –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–∞ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –ù–∞–π—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –ª–æ–≥
ls -lt migration_*.log | head -1

# –ü—Ä–æ—Å–º–æ—Ç—Ä
cat migration_*.log

# –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫
grep ERROR migration_*.log

# –ü–æ–∏—Å–∫ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
grep WARNING migration_*.log
```

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—Å—è –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

### –û–±–Ω–æ–≤–ª–µ–Ω–æ:
- ‚úÖ docker-compose.yml - –¥–æ–±–∞–≤–ª–µ–Ω—ã –ª–∏–º–∏—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è CPU
- ‚úÖ Caddyfile - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω —Å–∏–Ω—Ç–∞–∫—Å–∏—Å (—É–¥–∞–ª—ë–Ω auto_https)
- ‚úÖ Docker –æ–±—Ä–∞–∑—ã - –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω—ã —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ:
- ‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (data/caddy/certificates/)
- ‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (users.json)
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ VPN
- ‚úÖ –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

### –°–æ–∑–¥–∞–Ω–æ:
- üì¶ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø –≤ data/stealth-vpn/backups/
- üì¶ docker-compose.yml.pre-migration
- üì¶ config/Caddyfile.pre-migration
- üìù migration_TIMESTAMP.log

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker compose logs -f

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
./scripts/health-check.sh
```

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
docker compose restart caddy

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker compose logs -f admin

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
docker compose config

# –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps -a
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- üìñ [–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ](docs/MIGRATION_GUIDE.md)
- üìñ [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤](docs/MIGRATION_SCRIPTS.md)
- üìñ [–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](docs/TESTING_MIGRATION.md)
- üìã [–ß–µ–∫–ª–∏—Å—Ç](MIGRATION_TEST_CHECKLIST.md)
- üöÄ [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](QUICK_START_MIGRATION_TEST.md)

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ (—á–µ—Ä–µ–∑ 24-48 —á–∞—Å–æ–≤):

```bash
# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —É–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
rm docker-compose.yml.pre-migration
rm config/Caddyfile.pre-migration

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –æ–±—Ä–∞–∑–æ–≤
docker image prune -a

# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –±—ç–∫–∞–ø!
```

---

**–ì–æ—Ç–æ–≤—ã –∫ –º–∏–≥—Ä–∞—Ü–∏–∏?** –°–ª–µ–¥—É–π—Ç–µ —à–∞–≥–∞–º –≤—ã—à–µ! üöÄ
